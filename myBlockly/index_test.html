<!-- Author: Fu Chung-Yi (Kaohsiung, Taiwan)   https://www.facebook.com/francefu      Update date: 2019-1-8 -->

<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>myBlockly</title>
  <script>
	var script_blockly = [
		'https://blockly-demo.appspot.com/static/blockly_compressed.js',
		'https://blockly-demo.appspot.com/static/blocks_compressed.js',
		'https://blockly-demo.appspot.com/static/javascript_compressed.js',
		'https://fustyles.github.io/webduino/myBlockly/toolbox.js',
		
		'https://fustyles.github.io/webduino/myBlockly/example/Game_Tetris.js',
		'https://fustyles.github.io/webduino/myBlockly/example/Game_TicTacToe.js',
		'https://fustyles.github.io/webduino/myBlockly/example/Matrixled_Marquee_iloveyou.js',
		'https://fustyles.github.io/webduino/myBlockly/example/ShowText_example.js',
		'https://fustyles.github.io/webduino/myBlockly/example/Instruction_example.js',
		'https://fustyles.github.io/webduino/myBlockly/example/OpenURL_example.js',
		'https://fustyles.github.io/webduino/myBlockly/example/TaiwanAirQuality_example.js',
		'https://fustyles.github.io/webduino/myBlockly/example/MatrixLED_example.js',
		'https://fustyles.github.io/webduino/myBlockly/example/GameImage_example.js',
		'https://fustyles.github.io/webduino/myBlockly/example/GameCanvas_example.js',
		'https://fustyles.github.io/webduino/myBlockly/example/GameAuxiliary_example.js',
		
		'https://fustyles.github.io/webduino/myBlockly/SetWindow/blocks_SetWindow.js',
		'https://fustyles.github.io/webduino/myBlockly/SetWindow/javascript_SetWindow.js',
		'https://fustyles.github.io/webduino/myBlockly/SetWindow/toolbox_SetWindow.js',
		
		'https://fustyles.github.io/webduino/myBlockly/ShowText/blocks_ShowText.js',
		'https://fustyles.github.io/webduino/myBlockly/ShowText/javascript_ShowText.js',
		'https://fustyles.github.io/webduino/myBlockly/ShowText/toolbox_ShowText.js',
		
		'https://fustyles.github.io/webduino/myBlockly/Keyboard/blocks_Keyboard.js',
		'https://fustyles.github.io/webduino/myBlockly/Keyboard/javascript_Keyboard.js',
		'https://fustyles.github.io/webduino/myBlockly/Keyboard/toolbox_Keyboard.js',
		
		'https://fustyles.github.io/webduino/myBlockly/Instruction/blocks_Instruction.js',
		'https://fustyles.github.io/webduino/myBlockly/Instruction/javascript_Instruction.js',
		'https://fustyles.github.io/webduino/myBlockly/Instruction/toolbox_Instruction.js',
		
		'https://fustyles.github.io/webduino/myBlockly/MatrixLed/blocks_MatrixLed.js',
		'https://fustyles.github.io/webduino/myBlockly/MatrixLed/javascript_MatrixLed.js',
		'https://fustyles.github.io/webduino/myBlockly/MatrixLed/toolbox_MatrixLed.js',
		
		'https://fustyles.github.io/webduino/myBlockly/GameElements/blocks_GameElements.js',
		'https://fustyles.github.io/webduino/myBlockly/GameElements/javascript_GameElements.js',
		'https://fustyles.github.io/webduino/myBlockly/GameElements/toolbox_GameAuxiliary.js',
		'https://fustyles.github.io/webduino/myBlockly/GameElements/toolbox_GameTable.js',
		'https://fustyles.github.io/webduino/myBlockly/GameElements/toolbox_GameCanvas.js',
		'https://fustyles.github.io/webduino/myBlockly/GameElements/toolbox_GameImage.js',
		'https://fustyles.github.io/webduino/myBlockly/GameElements/toolbox_GameForm.js',
		
		'https://fustyles.github.io/webduino/myBlockly/OpenURL/blocks_OpenURL.js',
		'https://fustyles.github.io/webduino/myBlockly/OpenURL/javascript_OpenURL.js',
		'https://fustyles.github.io/webduino/myBlockly/OpenURL/toolbox_OpenURL.js',
		
		'https://fustyles.github.io/webduino/myBlockly/TaiwanAirQuality/blocks_TaiwanAirQuality.js',
		'https://fustyles.github.io/webduino/myBlockly/TaiwanAirQuality/javascript_TaiwanAirQuality.js',
		'https://fustyles.github.io/webduino/myBlockly/TaiwanAirQuality/toolbox_TaiwanAirQuality.js',
		
		'https://ajax.googleapis.com/ajax/libs/jquery/1.8.0/jquery.min.js'
	];
	for (var i=0;i<script_blockly.length;i++) {
	  document.write("\<script src='"+script_blockly[i]+"'\>\<\/script>");
	}
	var language = location.search.toLowerCase();
	if (language.indexOf("lang=zh-hant")!=-1)
	{
		var script_msg = [
		'https://fustyles.github.io/webduino/myBlockly/zh-hant.js',
		'https://fustyles.github.io/webduino/myBlockly/SetWindow/msg_SetWindow_zh-hant.js',
		'https://fustyles.github.io/webduino/myBlockly/ShowText/msg_ShowText_zh-hant.js',
		'https://fustyles.github.io/webduino/myBlockly/Keyboard/msg_Keyboard_zh-hant.js',
		'https://fustyles.github.io/webduino/myBlockly/Instruction/msg_Instruction_zh-hant.js',
		'https://fustyles.github.io/webduino/myBlockly/MatrixLed/msg_MatrixLed_zh-hant.js',
		'https://fustyles.github.io/webduino/myBlockly/GameElements/msg_GameElements_zh-hant.js',
		'https://fustyles.github.io/webduino/myBlockly/OpenURL/msg_OpenURL_zh-hant.js',
		'https://fustyles.github.io/webduino/myBlockly/TaiwanAirQuality/msg_TaiwanAirQuality_zh-hant.js'
		];
	} 
	else if (language.indexOf("lang=zh-hans")!=-1) {
		var script_msg = [
		'https://fustyles.github.io/webduino/myBlockly/zh-hans.js',
		'https://fustyles.github.io/webduino/myBlockly/SetWindow/msg_SetWindow_zh-hans.js',
		'https://fustyles.github.io/webduino/myBlockly/ShowText/msg_ShowText_zh-hans.js',
		'https://fustyles.github.io/webduino/myBlockly/Keyboard/msg_Keyboard_zh-hans.js',
		'https://fustyles.github.io/webduino/myBlockly/Instruction/msg_Instruction_zh-hans.js',
		'https://fustyles.github.io/webduino/myBlockly/MatrixLed/msg_MatrixLed_zh-hans.js',
		'https://fustyles.github.io/webduino/myBlockly/GameElements/msg_GameElements_zh-hans.js',
		'https://fustyles.github.io/webduino/myBlockly/OpenURL/msg_OpenURL_zh-hans.js',
		'https://fustyles.github.io/webduino/myBlockly/TaiwanAirQuality/msg_TaiwanAirQuality_zh-hans.js'
		];
	} 
	else {
		var script_msg = [
		'https://fustyles.github.io/webduino/myBlockly/en.js',
		'https://fustyles.github.io/webduino/myBlockly/SetWindow/msg_SetWindow.js',
		'https://fustyles.github.io/webduino/myBlockly/ShowText/msg_ShowText.js',
		'https://fustyles.github.io/webduino/myBlockly/Keyboard/msg_Keyboard.js',
		'https://fustyles.github.io/webduino/myBlockly/Instruction/msg_Instruction.js',
		'https://fustyles.github.io/webduino/myBlockly/MatrixLed/msg_MatrixLed.js',
		'https://fustyles.github.io/webduino/myBlockly/GameElements/msg_GameElements.js',
		'https://fustyles.github.io/webduino/myBlockly/OpenURL/msg_OpenURL.js',
		'https://fustyles.github.io/webduino/myBlockly/TaiwanAirQuality/msg_TaiwanAirQuality.js'
		];
	}
	for (var i=0;i<script_msg.length;i++) {
	  document.write("\<script src='"+script_msg[i]+"'\>\<\/script>");
	}
	var script_iframe_run = [
		'https://ajax.googleapis.com/ajax/libs/jquery/1.8.0/jquery.min.js',
		'https://fustyles.github.io/webduino/myBlockly/ShowText/showtext.js',
		'https://fustyles.github.io/webduino/myBlockly/SetWindow/setwindow.js',
		'https://fustyles.github.io/webduino/myBlockly/MatrixLed/matrixled.js',
		'https://fustyles.github.io/webduino/myBlockly/GameElements/gameelements.js',
		'https://fustyles.github.io/webduino/myBlockly/OpenURL/openurl.js',
		'https://fustyles.github.io/webduino/myBlockly/TaiwanAirQuality/taiwanairquality.js'
	];
  </script>

</head>
<body></div>
	
<div id="blocklyDiv" style="height: 600px; width: 800px;">
<xml id="toolbox" style="display: none"></xml>
<xml id="startBlocks" style="display: none"></xml>
		
<script>
//append category to toolbox
var category = [
	catSystem,
	"<sep></sep>",
].join("");
while (category.toLowerCase().indexOf("<category")!=-1||category.toLowerCase().indexOf("<sep>")!=-1) {
  var s = category.toLowerCase().indexOf("<category");
  var s1 = category.toLowerCase().indexOf("<sep>");
  if (s1!=-1&&s1<s) {
    var e1 = category.toLowerCase().indexOf("</sep>");
    var xml = Blockly.Xml.textToDom("<xml>"+category.substring(s1,e1+6)+"</xml>");
    document.getElementById('toolbox').append(xml.firstChild);
    category=category.substr(e1+6);
  } else {
    var e = category.toLowerCase().indexOf("</category>");
    var xml = Blockly.Xml.textToDom("<xml>"+category.substring(s,e+11)+"</xml>");
    document.getElementById('toolbox').append(xml.firstChild);
    category=category.substr(e+11);
  }
}
	
var demoWorkspace = Blockly.inject('blocklyDiv',{media: 'https://blockly-demo.appspot.com/static/media/', toolbox: document.getElementById('toolbox'),zoom:{controls: true,wheel: true,startScale: 1.0,maxScale: 3,minScale: 0.3,scaleSpeed: 1.2},trashcan: true});
Blockly.Xml.domToWorkspace(document.getElementById('startBlocks'),demoWorkspace);
		
if (demoWorkspace.getBlocksByType('procedures_defnoreturn')) {
  for (var i=0;i<demoWorkspace.getBlocksByType('procedures_defnoreturn').length;i++) {
    demoWorkspace.getBlocksByType('procedures_defnoreturn')[i].setPreviousStatement(true, null); 
    demoWorkspace.getBlocksByType('procedures_defnoreturn')[i].setNextStatement(true, null);
    console.log(demoWorkspace.getBlocksByType('procedures_defnoreturn')[i]);
  }
}

</script>
</body>
</html>
