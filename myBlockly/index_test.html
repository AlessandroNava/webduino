<!-- Author: Fu Chung-Yi (Kaohsiung, Taiwan)   https://www.facebook.com/francefu      Update date: 2019-1-8 -->

<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>myBlockly</title>
</head>
<body></div>
	
<div id="blocklyDiv" style="height: 600px; width: 800px;">
<xml id="toolbox" style="display: none"></xml>
<xml id="startBlocks" style="display: none"></xml>
		
<script>
//append category to toolbox
var category = [
	catSystem,
	"<sep></sep>",
	catSetWindow,
	catShowText,
	catKeyboard,
	catInstruction,
	catGameAuxiliary,
	catGameTable,
	catGameCanvas,
	catGameImage,
	catGameForm,
	catMatrixLed,
	catOpenURL,
	catTaiwanAirQuality
].join("");
while (category.toLowerCase().indexOf("<category")!=-1||category.toLowerCase().indexOf("<sep>")!=-1) {
  var s = category.toLowerCase().indexOf("<category");
  var s1 = category.toLowerCase().indexOf("<sep>");
  if (s1!=-1&&s1<s) {
    var e1 = category.toLowerCase().indexOf("</sep>");
    var xml = Blockly.Xml.textToDom("<xml>"+category.substring(s1,e1+6)+"</xml>");
    document.getElementById('toolbox').append(xml.firstChild);
    category=category.substr(e1+6);
  } else {
    var e = category.toLowerCase().indexOf("</category>");
    var xml = Blockly.Xml.textToDom("<xml>"+category.substring(s,e+11)+"</xml>");
    document.getElementById('toolbox').append(xml.firstChild);
    category=category.substr(e+11);
  }
}
	
var demoWorkspace = Blockly.inject('blocklyDiv',{media: 'https://blockly-demo.appspot.com/static/media/', toolbox: document.getElementById('toolbox'),zoom:{controls: true,wheel: true,startScale: 1.0,maxScale: 3,minScale: 0.3,scaleSpeed: 1.2},trashcan: true});
Blockly.Xml.domToWorkspace(document.getElementById('startBlocks'),demoWorkspace);
		
if (demoWorkspace.getBlocksByType('procedures_defnoreturn')) {
  for (var i=0;i<demoWorkspace.getBlocksByType('procedures_defnoreturn').length;i++) {
    demoWorkspace.getBlocksByType('procedures_defnoreturn')[i].setPreviousStatement(true, null); 
    demoWorkspace.getBlocksByType('procedures_defnoreturn')[i].setNextStatement(true, null);
  }
}
if (demoWorkspace.getBlocksByType('procedures_defreturn')) {
  for (var i=0;i<demoWorkspace.getBlocksByType('procedures_defreturn').length;i++) {
    demoWorkspace.getBlocksByType('procedures_defreturn')[i].setPreviousStatement(true, null); 
    demoWorkspace.getBlocksByType('procedures_defreturn')[i].setNextStatement(true, null);
  }
}

</script>
</body>
</html>
